<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lengkapi Data â€” Latihan Soal UAS UT</title>
  <style>
    :root{ --navy:#002D5F; --accent:#A1C0F8; --black:#000; --white:#fff; }
    body{ margin:0; font-family: Calibri, "Times New Roman", serif; background: var(--white); color: var(--black); }
    .topbar{ background: var(--navy); color: var(--white); padding: 16px 18px; display:flex; align-items:center; }
    .brand{ display:flex; align-items:center; gap:10px; }
    .brand img{ width:34px; height:34px; object-fit:contain; }
    .brand-title{ font-size:14px; font-weight:700; }
    .container{ max-width: 520px; margin: 40px auto; padding: 0 16px; }
    .card{ border: 1px solid rgba(0,0,0,0.10); border-radius: 14px; box-shadow: 0 6px 16px rgba(0,0,0,0.06); padding: 20px; }
    h1{ margin:0 0 10px 0; font-size:18px; color: var(--navy); }
    .sub{ font-size:13px; color: rgba(0,0,0,0.75); margin-bottom:16px; }
    input{
      width:100%;
      padding: 12px;
      border-radius:10px;
      border:1px solid rgba(0,0,0,0.2);
      font-size:14px;
      margin-bottom:12px;
    }
    button{
      background: var(--navy);
      color: var(--white);
      border:none;
      padding:12px;
      border-radius:10px;
      font-weight:700;
      cursor:pointer;
      width:100%;
    }
    .error{ margin-top:10px; font-size:13px; color:#b00020; display:none; }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <img src="assets/logo.png" alt="Logo" onerror="this.style.display='none'">
      <div class="brand-title">Latihan Soal UAS UT by Jokitoefl.my.id</div>
    </div>
  </header>

  <main class="container">
    <div class="card">
      <h1>Lengkapi Data</h1>
      <div class="sub">Masukkan nama yang akan ditampilkan di halaman dashboard.</div>

      <input id="displayName" placeholder="Contoh: Caca Anyong" />
      <button id="btnSave">Lanjut</button>
      <div id="msgError" class="error"></div>
    </div>
  </main>

  <script>
    const WORKER_BASE = "https://jokitoefl-gate.meimeibkn.workers.dev";
    const msgError = document.getElementById("msgError");

    async function checkLogin(){
      const res = await fetch(`${WORKER_BASE}/api/me`, { method:"GET", credentials:"include" });
      const data = await res.json().catch(()=>({}));
      if(!res.ok || !data.ok){
        window.location.href = "index.html";
      }
    }

    document.getElementById("btnSave").addEventListener("click", ()=>{
      const name = document.getElementById("displayName").value.trim();
      if(!name){
        msgError.textContent = "Nama tidak boleh kosong.";
        msgError.style.display = "block";
        return;
      }
      localStorage.setItem("display_name", name);
      window.location.href = "dashboard.html";
    });

    checkLogin();
  </script>
</body>
</html>
